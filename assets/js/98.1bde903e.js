(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{388:function(a,t,s){"use strict";s.r(t);var e=s(13),n=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"cas"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cas"}},[a._v("#")]),a._v(" CAS")]),a._v(" "),t("p",[t("em",[a._v("pac4j")]),a._v(" 允许你以多种方式登录 CAS 服务器：")]),a._v(" "),t("ol",[t("li",[a._v("使用 "),t("strong",[a._v("CAS 登录页面")]),a._v("（用于 web 网站）：当访问受保护的网站时，用户将被重定向到 CAS 登录页面，以输入其凭据，然后才被授予访问该网站的权限")]),a._v(" "),t("li",[a._v("使用"),t("strong",[a._v("代理票证")]),a._v("（对于 web 服务）：如果用户已经在 web 应用程序中通过了 CAS 的身份验证（用例1），则 web 应用程序可以请求代理票证并使用它调用受 CAS 保护的 web 服务")]),a._v(" "),t("li",[a._v("使用 "),t("strong",[a._v("CAS REST API")]),a._v("（用于 web 服务）：独立/移动应用程序可以通过提供 CAS 用户凭据来调用 web 服务（这些凭据将通过 CAS REST API 直接检查）")])]),a._v(" "),t("p",[a._v("它支持所有 CAS 协议版本（v1.0、v2.0 和 v3.0）。")]),a._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[a._v("注意")]),a._v(" "),t("p",[a._v("CAS 服务器还可以充当 SAML IdP、OpenID Connect 提供者或 OpenID 提供者。在这种情况下，你不能使用 CAS 支持，而必须使用适当的 SAML、OpenID Connect 或 OpenID 支持。")])]),a._v(" "),t("h2",{attrs:{id:"_0-依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-依赖"}},[a._v("#")]),a._v(" 0）依赖")]),a._v(" "),t("p",[a._v("你需要使用以下模块："),t("code",[a._v("pac4j-cas")]),a._v("。")]),a._v(" "),t("p",[t("strong",[a._v("示例（Maven 依赖）")]),a._v("：")]),a._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("org.pac4j"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("pac4j-cas"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("${pac4j.version}"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("h2",{attrs:{id:"_1-cas-登录页面-web-网站"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-cas-登录页面-web-网站"}},[a._v("#")]),a._v(" 1）CAS 登录页面（web 网站）")]),a._v(" "),t("h3",{attrs:{id:"a-应用配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#a-应用配置"}},[a._v("#")]),a._v(" a）应用配置")]),a._v(" "),t("p",[a._v("要使用 CAS 服务器登录，必须定义间接 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/client/CasClient.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("CasClient"),t("OutboundLink")],1),a._v("（也可以定义 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/client/CasProxyReceptor.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("CasProxyReceptor"),t("OutboundLink")],1),a._v(" 来代理处理）。因此，受 "),t("code",[a._v("CasClient")]),a._v(" 保护的 web 应用程序将参与 SSO。")]),a._v(" "),t("p",[a._v("必须在 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/config/CasConfiguration.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("CasConfiguration"),t("OutboundLink")],1),a._v(" 对象中定义 CAS 配置。")]),a._v(" "),t("p",[t("strong",[a._v("示例")]),a._v("：")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasClient")]),a._v(" casClient "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasClient")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasConfiguration")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"https://mycasserver/login"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("code",[a._v("https://mycasserver/login")]),a._v(" 是你的 CAS 服务器的登录 URL。")]),a._v(" "),t("p",[a._v("成功登录 CAS 服务器后，会返回 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/profile/CasProfile.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("CasProfile"),t("OutboundLink")],1),a._v("。")]),a._v(" "),t("p",[a._v("如果在 CAS 中发生认证委派，并且未定义代理配置，则返回的配置文件将是认证委派后的原始配置文件。")]),a._v(" "),t("p",[t("code",[a._v("CasConfiguration")]),a._v(" 可以使用 CAS 登录 URL 和/或 CAS 前缀 URL 构建（当需要不同的 URL 时）：")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasConfiguration")]),a._v(" config "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasConfiguration")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("setLoginUrl")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"https://casserverpac4j.herokuapp.com/login"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("setPrefixUrl")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://internal-cas-url"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("p",[a._v("你可以定义要使用的 CAS 协议（默认情况下为 "),t("code",[a._v("CasProtocol.CAS30")]),a._v("）：")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[a._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("setProtocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasProtocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("CAS20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("你还可以设置各种参数：")]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("方法")]),a._v(" "),t("th",[a._v("用途")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("setEncoding(String)")]),a._v(" "),t("td",[a._v("定义用于处理 CAS 响应的编码")])]),a._v(" "),t("tr",[t("td",[a._v("setRenew(boolean)")]),a._v(" "),t("td",[a._v("定义是否使用刷新参数")])]),a._v(" "),t("tr",[t("td",[a._v("setGateway(boolean)")]),a._v(" "),t("td",[a._v("定义是否使用网关参数")])]),a._v(" "),t("tr",[t("td",[a._v("setTimeTolerance(long)")]),a._v(" "),t("td",[a._v("定义 SAML 票据校验 (CasProtocol.SAML)的容忍时长")])]),a._v(" "),t("tr",[t("td",[a._v("setCallbackUrlResolver(CallbackUrlResolver)")]),a._v(" "),t("td",[a._v("定义一个特定的 "),t("code",[a._v("CallbackUrlResolver")]),a._v(" （默认使用 "),t("code",[a._v("CasClient")]),a._v(" 的 "),t("code",[a._v("CallbackUrlResolver")]),a._v(")")])]),a._v(" "),t("tr",[t("td",[a._v("setDefaultTicketValidator(TicketValidator)")]),a._v(" "),t("td",[a._v("定义默认使用的 "),t("code",[a._v("TicketValidator")])])])])]),a._v(" "),t("h3",{attrs:{id:"b-cas-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#b-cas-配置"}},[a._v("#")]),a._v(" b）CAS 配置")]),a._v(" "),t("p",[a._v("假定你的回调 URL 是 "),t("code",[a._v("http://localhost:8080/callback")]),a._v("，CAS 服务器默认会被 "),t("code",[a._v("https://mycasserver/login?service=http://localhost:8080/callback?client_name=CasClient")]),a._v(" 调用。")]),a._v(" "),t("p",[a._v("因此，你必须在 CAS 服务注册表中定义与此 URL 匹配的合适的 CAS 服务："),t("code",[a._v("http://localhost:8080/callback?client_name=CasClient")]),a._v("，并且使用适当的配置：返回哪些属性？它支持代理吗？")]),a._v(" "),t("p",[a._v("阅读 "),t("a",{attrs:{href:"https://apereo.github.io/cas/6.2.x/services/Service-Management.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("CAS 文档"),t("OutboundLink")],1),a._v("了解。")]),a._v(" "),t("h3",{attrs:{id:"c-代理支持"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#c-代理支持"}},[a._v("#")]),a._v(" c）代理支持")]),a._v(" "),t("p",[a._v("对于代理支持，必须使用 "),t("code",[a._v("CasProxyReceptor")]),a._v(" 组件，在相同或新的回调 URL 上定义（通过"),t("RouterLink",{attrs:{to:"/v5.7/config.html"}},[a._v("安全配置")]),a._v("），并在 "),t("code",[a._v("CasConfiguration")]),a._v(" 中声明：")],1),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasProxyReceptor")]),a._v(" casProxy "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasProxyReceptor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("setProxyReceptor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("casProxy"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// config.setAcceptAnyProxy(false);")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// config.setAllowedProxyChains(proxies);")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("p",[a._v("在这种情况下，成功认证后会返回 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/profile/CasProxyProfile.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("CasProxyProfile"),t("OutboundLink")],1),a._v("，它可以用于获取其他 CAS 服务的代理票据：")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasProxyProfile")]),a._v(" casProxyProfile "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasProxyProfile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" casProfile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" proxyTicket "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" casProxyProfile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("getProxyTicketFor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("anotherCasServiceUrl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("p",[a._v("为了关联代理信息，"),t("code",[a._v("CasProxyReceptor")]),a._v(" 使用一个内部"),t("RouterLink",{attrs:{to:"/v5.7/store.html"}},[a._v("存储")]),a._v("，你可以通过 "),t("code",[a._v("setStore")]),a._v(" 方法更改该存储（默认情况下，使用 "),t("code",[a._v("Guava")]),a._v("）。")],1),a._v(" "),t("h3",{attrs:{id:"d-注销配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#d-注销配置"}},[a._v("#")]),a._v(" d）注销配置")]),a._v(" "),t("p",[a._v("为了处理 CAS 注销请求，会自动创建 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-core/src/main/java/org/pac4j/core/logout/handler/DefaultLogoutHandler.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("DefaultLogoutHandler"),t("OutboundLink")],1),a._v("。除非你指定自己的 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-core/src/main/java/org/pac4j/core/logout/handler/LogoutHandler.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("LogoutHandler"),t("OutboundLink")],1),a._v(" 接口实现。")]),a._v(" "),t("p",[t("code",[a._v("DefaultLogoutHandler")]),a._v("：")]),a._v(" "),t("ul",[t("li",[a._v("依赖于 "),t("code",[a._v("SessionStore")]),a._v(" 的功能（"),t("code",[a._v("destroySession")]),a._v("、"),t("code",[a._v("getTrackableSession")]),a._v(" 和 "),t("code",[a._v("buildFromTrackableSession")]),a._v(" 方法）")]),a._v(" "),t("li",[a._v("将数据存储在可以通过 "),t("code",[a._v("setStore")]),a._v(" 方法更改的"),t("RouterLink",{attrs:{to:"/v5.7/store.html"}},[a._v("存储")]),a._v("中（默认情况下，使用 "),t("code",[a._v("Guava")]),a._v("）。")],1)]),a._v(" "),t("h3",{attrs:{id:"e-无状态方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#e-无状态方式"}},[a._v("#")]),a._v(" e）无状态方式")]),a._v(" "),t("p",[a._v("事实上，你甚至可以使用 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/client/direct/DirectCasClient.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("DirectCasClient"),t("OutboundLink")],1),a._v(" 登录 CAS 登录页面。不涉及回调 URL：请求的 URL 将在 CAS 登录后回调。不会创建会话，因此不需要注销。")]),a._v(" "),t("h2",{attrs:{id:"_2-代理票据-web-服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-代理票据-web-服务"}},[a._v("#")]),a._v(" 2）代理票据（web 服务）")]),a._v(" "),t("p",[a._v("如果要通过 CAS 认证从 web 应用程序调用 web 服务，则必须按照上述说明使用代理模式。")]),a._v(" "),t("p",[a._v("生成的代理票据必须发送到 web 服务，并且 web 服务必须由 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/client/direct/DirectCasProxyClient.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("DirectCasProxyClient"),t("OutboundLink")],1),a._v(" 正确保护。它必需 "),t("code",[a._v("CasConfiguration")]),a._v("。")]),a._v(" "),t("p",[t("strong",[a._v("示例")]),a._v("：")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasConfiguration")]),a._v(" config "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasConfiguration")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("setLoginUrl")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"https://casserverpac4j.herokuapp.com/login"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("setProtocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasProtocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("CAS30_PROXY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("DirectCasProxyClient")]),a._v(" directCasProxyClient "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("DirectCasProxyClient")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://localhost:8080/webservices"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("p",[a._v("生成代理票据（如 "),t("code",[a._v("PT-1")]),a._v("）后，将在类似的 URL 上调用 web 服务："),t("code",[a._v("http://localhost:8080/webservices/myoperation?ticket=PT-1")]),a._v("。")]),a._v(" "),t("p",[a._v("可以在 "),t("code",[a._v("CasConfiguration")]),a._v(" 对象上的 "),t("code",[a._v("setAllowedProxies")]),a._v("（"),t("code",[a._v("List<String>")]),a._v("）方法定义 URL 模式列表，它可以允许哪些应用程序充当此应用程序的代理。")]),a._v(" "),t("p",[t("code",[a._v("DirectCasProxyClient")]),a._v(" 将验证代理票据和服务 URL（在构造函数中定义："),t("code",[a._v("http://localhost:8080/webservices")]),a._v(")以获取用户的身份。")]),a._v(" "),t("p",[a._v("这需要定义适当的 CAS 服务（匹配 "),t("code",[a._v("http://localhost:8080/webservicesURL")]),a._v("）。")]),a._v(" "),t("p",[a._v("此 "),t("code",[a._v("DirectCasProxyClient")]),a._v(" 内部依赖于 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/credentials/authenticator/CasAuthenticator.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("CasAuthenticator"),t("OutboundLink")],1),a._v("。了解如何"),t("RouterLink",{attrs:{to:"/v5.7/authenticators.html#_1-处理性能问题"}},[a._v("处理性能问题")]),a._v("。")],1),a._v(" "),t("h2",{attrs:{id:"_3-cas-rest-api-web-服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-cas-rest-api-web-服务"}},[a._v("#")]),a._v(" 3）CAS REST API（web 服务）")]),a._v(" "),t("p",[a._v("如果启用了该功能，则可以通过 "),t("a",{attrs:{href:"https://apereo.github.io/cas/6.2.x/protocol/REST-Protocol.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("REST API"),t("OutboundLink")],1),a._v(" 调用 CAS 服务器。")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/client/rest/CasRestFormClient.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("CasRestFormClient"),t("OutboundLink")],1),a._v(" 和 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/client/rest/CasRestBasicAuthClient.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("CasRestBasicAuthClient"),t("OutboundLink")],1),a._v(" 是直接客户端，可用于与 CAS 服务器的 REST API 交互：")]),a._v(" "),t("ul",[t("li",[a._v("如果用户的用户名/密码是通过基本身份验证发送的，"),t("code",[a._v("CasRestBasicAuthClient")]),a._v(" 将获取它们并通过 CAS REST API 进行验证")]),a._v(" "),t("li",[a._v("如果凭证是通过表单参数发送的，"),t("code",[a._v("CasRestFormClient")]),a._v(" 将接收凭证并通过 CAS REST API 进行验证。")])]),a._v(" "),t("p",[t("strong",[a._v("示例")]),a._v("：")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasConfiguration")]),a._v(" casConfig "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasConfiguration")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"https://mycasserver/login"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasRestFormClient")]),a._v(" casRestClient "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CasRestFormClient")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("casConfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("p",[a._v("这些直接客户端在内部依赖 "),t("a",{attrs:{href:"https://github.com/pac4j/pac4j/blob/master/pac4j-cas/src/main/java/org/pac4j/cas/credentials/authenticator/CasAuthenticator.jav",target:"_blank",rel:"noopener noreferrer"}},[a._v("CasRestAuthenticator"),t("OutboundLink")],1),a._v("。了解如何"),t("RouterLink",{attrs:{to:"/v5.7/authenticators.html#_1-处理性能问题"}},[a._v("处理性能问题")]),a._v("。")],1),a._v(" "),t("p",[a._v("通过 "),t("code",[a._v("CasRestBasicAuthClient")]),a._v("/"),t("code",[a._v("CasRestFormClient")]),a._v(" 成功验证后，将创建 "),t("code",[a._v("CasRestProfile")]),a._v("。")]),a._v(" "),t("p",[a._v("此配置文件没有属性，因为它是通过在 REST API 上验证 CAS 凭据而构建的。你必须请求服务票据并对其进行验证，才能获得具有属性的 "),t("code",[a._v("CasProfile")]),a._v("（因为使用的默认协议是 CAS v3.0）。")]),a._v(" "),t("p",[a._v("事实上，使用 "),t("code",[a._v("CasRestProfile")]),a._v("，你将能够：")]),a._v(" "),t("ul",[t("li",[a._v("请求服务票据："),t("code",[a._v("TokenCredentials tokenCredential=casRestClient.requestServiceTicket(serviceUrl,casRestProfile,context)")])]),a._v(" "),t("li",[a._v("验证它们："),t("code",[a._v("CasProfile casProfile = casRestClient.validateServiceTicket(serviceUrl, tokenCredentials, context)")])]),a._v(" "),t("li",[a._v("或销毁以前的身份验证："),t("code",[a._v("CasProfile casProfile = casRestClient.validateServiceTicket(serviceUrl, tokenCredentials, context)")]),a._v("。")])]),a._v(" "),t("blockquote",[t("p",[t("a",{attrs:{href:"https://www.pac4j.org/4.5.x/docs/clients/cas.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("原文链接"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);